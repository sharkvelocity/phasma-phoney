<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phasma-Phoney</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-top: 40px;
      font-size: 2.5em;
      color: cyan;
      text-shadow: 0 0 10px cyan;
    }
    #start-btn, .action-btn {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      background: #333;
      color: white;
      border: 1px solid #666;
      cursor: pointer;
    }
    .hidden { display: none; }
    #game-screen {
      display: flex;
      width: 100%;
      padding: 10px;
    }
    #left-panel, #right-panel {
      width: 20%;
      padding: 10px;
    }
    #center-panel {
      width: 60%;
      padding: 10px;
    }
    #narrator-box, #main-readout, #mini-map, #hud-status {
      margin-bottom: 10px;
      padding: 10px;
      background: #111;
      border: 1px solid #444;
    }
    #journal-screen {
      position: fixed;
      top: 20%;
      left: 10%;
      width: 80%;
      background: #111;
      border: 2px solid #666;
      padding: 12px;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <h1>Phasma-Phoney</h1>
  <button id="start-btn">Start Investigation</button>

  <div id="game-screen" class="hidden">
    <div id="left-panel">
      <div id="option-buttons"></div>
      <button id="journal-btn" class="action-btn">Journal</button>
      <button id="guess-btn" class="action-btn">Guess Ghost</button>
      <button id="item-btn" class="action-btn">Use Item</button>
      <button id="van-btn" class="action-btn">Return to Van</button>
    </div>
    <div id="center-panel">
      <div id="narrator-box">Narrator text will appear here.</div>
      <div id="hud-status">Sanity: 100% | XP: 0 | Inventory: none</div>
      <div id="main-readout">Awaiting interaction...</div>
    </div>
    <div id="right-panel">
      <div id="mini-map">Room: Unknown</div>
    </div>
  </div>

  <div id="journal-screen" class="hidden">
    <h2>Journal</h2>
    <textarea id="journal-entry" style="width:100%;height:100px;"></textarea><br>
    <button id="save-journal">Save</button>
    <button id="close-journal">Close</button>
  </div>

  <script>
    // Minimal ghost behavior engine with 26 types
    const ghostTypes = [
      'Spirit', 'Wraith', 'Phantom', 'Poltergeist', 'Banshee',
      'Jinn', 'Mare', 'Revenant', 'Shade', 'Demon',
      'Yurei', 'Oni', 'Hantu', 'Yokai', 'Goryo',
      'Myling', 'Onryo', 'The Twins', 'Raiju', 'Obake',
      'The Mimic', 'Moroi', 'Deogen', 'Thaye', 'Succubus'
    ];
    let currentGhost = null;

    function getRandomGhost() {
      const type = ghostTypes[Math.floor(Math.random() * ghostTypes.length)];
      return { type };
    }

    function generateBehavior(type) {
      return (room) => `The ${type} stirs in the ${room}. You feel uneasy.`;
    }

    // Game state
    let ghost;
    let sanity = 100;
    let inventory = ['EMF Reader'];
    let room = 'Foyer';
    let xp = 0;

    function startGame() {
      ghost = getRandomGhost();
      currentGhost = ghost;
      currentGhost.behaviorMap = generateBehavior(ghost.type);
      document.getElementById('start-btn').classList.add('hidden');
      document.getElementById('game-screen').classList.remove('hidden');
      updateHUD();
      displayNarratorText(`A new investigation begins... You feel watched.`);
      renderOptions();
    }

    function renderOptions() {
      const container = document.getElementById('option-buttons');
      container.innerHTML = '';
      ['Investigate', 'Use Item', 'Move', 'Guess', 'Van'].forEach((label, idx) => {
        const btn = document.createElement('button');
        btn.className = 'action-btn';
        btn.textContent = `${idx + 1}. ${label}`;
        btn.onclick = () => handleAction(label);
        container.appendChild(btn);
      });
    }

    function handleAction(label) {
      if (label === 'Investigate') {
        const result = currentGhost.behaviorMap(room);
        displayNarratorText(result);
        sanity -= 5;
        updateHUD();
      } else if (label === 'Use Item') {
        if (inventory.length === 0) {
          displayNarratorText('You have no items to use.');
          return;
        }
        displayNarratorText(`You use your ${inventory[0]}. Nothing happens.`);
        sanity -= 2;
        updateHUD();
      } else if (label === 'Move') {
        room = ['Foyer', 'Living Room', 'Basement', 'Garage'][Math.floor(Math.random() * 4)];
        displayNarratorText(`You move into the ${room}. It's eerily quiet.`);
        updateHUD();
      } else if (label === 'Guess') {
        const guess = prompt('What type of ghost is this?');
        if (guess?.toLowerCase() === currentGhost.type.toLowerCase()) {
          displayNarratorText(`Correct! It was a ${currentGhost.type}. You gain XP.`);
          xp += 10;
        } else {
          displayNarratorText(`Wrong. It was a ${currentGhost.type}. You flee in terror.`);
        }
        updateHUD();
      } else if (label === 'Van') {
        displayNarratorText('You return to the van. Investigation ends.');
        sanity = 100;
        xp = 0;
        updateHUD();
      }
    }

    function displayNarratorText(text) {
      const box = document.getElementById('narrator-box');
      const log = document.getElementById('main-readout');
      box.textContent = text;
      log.textContent += '\n' + text;
      log.scrollTop = log.scrollHeight;
    }

    function updateHUD() {
      document.getElementById('hud-status').textContent = `Sanity: ${sanity}% | XP: ${xp} | Inventory: ${inventory.join(', ') || 'none'}`;
      document.getElementById('mini-map').textContent = `Room: ${room}`;
    }

    // Journal
    document.getElementById('journal-btn').onclick = () => {
      document.getElementById('journal-screen').classList.remove('hidden');
    };
    document.getElementById('close-journal').onclick = () => {
      document.getElementById('journal-screen').classList.add('hidden');
    };
    document.getElementById('save-journal').onclick = () => {
      const notes = document.getElementById('journal-entry').value;
      displayNarratorText(`Journal updated.`);
    };

    // Start
    document.getElementById('start-btn').onclick = startGame;
  </script>
</body>
</html>
