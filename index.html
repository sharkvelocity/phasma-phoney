<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PhasmaPhoney</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="Shark-Blades" />
  <meta name="description" content="Turn-based ghost hunting strategy game based on Phasmophobia." />
  <meta name="keywords" content="PhasmaPhoney, Phasmophobia, ghost, game, ADA, investigation" />
  <meta property="og:type" content="game" />
  <meta property="og:site_name" content="PhasmaPhoney" />
  <meta name="google-site-verification" content="2zaxjMijj2SXwFDx3Fe6sQUNzXXZiAAkAP92q6ZFWSg" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background: #000;
      font-family: monospace;
      color: #0ff;
      overflow: hidden;
    }
    #flash-overlay, #orb-canvas, #clouds1, #clouds2 {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
    }
    #flash-overlay {
      background: white;
      opacity: 0;
      z-index: 9999;
    }
    #orb-canvas {
      z-index: 199;
    }
    #clouds1, #clouds2 {
      z-index: 200;
      background-repeat: repeat-x;
      background-size: cover;
    }
    #clouds1 {
      background: linear-gradient(to right, rgba(255,255,255,0.05), rgba(0,0,0,0));
      opacity: 0.4;
      animation: cloudDrift1 80s linear infinite;
    }
    #clouds2 {
      background: linear-gradient(to right, rgba(255,255,255,0.08), rgba(0,0,0,0));
      opacity: 0.3;
      animation: cloudDrift2 120s linear infinite;
    }
    @keyframes cloudDrift1 {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    @keyframes cloudDrift2 {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    #background-logo {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: url("./logo.png") center center no-repeat;
      background-size: contain;
      opacity: 0.1;
      z-index: -4;
    }
    #title-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: black;
      z-index: 5000;
    }
    #title-screen button {
      font-size: 24px;
      padding: 16px 32px;
      background: #111;
      color: #eee;
      border: 2px solid #444;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Layered effects -->
  <div id="clouds1"></div>
  <div id="clouds2"></div>
  <div id="flash-overlay"></div>
  <canvas id="orb-canvas"></canvas>
  <div id="background-logo"></div>

  <!-- Title Screen -->
  <div id="title-screen">
    <img src="./logo.png" alt="PhasmaPhoney" style="max-width: 80%; margin-bottom: 30px;" />
    <button onclick="startLoadout()">Start Investigation</button>
    <p style="margin-top: 10px; font-style: italic;">Deo: ‚ÄúHope your guesswork's better than your flashlight.‚Äù</p>
  </div>
  <!-- Loadout Screen -->
  <div id="loadout-screen" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;
       background:#000;color:#0ff;z-index:5000;padding:20px;font-family:monospace;overflow-y:auto;">
    <h2 style="text-align:center;">Select Your Loadout (Pick 3 Items)</h2>
    <div id="item-selection" style="display:flex;flex-wrap:wrap;gap:12px;justify-content:center;margin:20px 0;">
      <!-- Items populated by script -->
    </div>
    <div style="text-align:center;margin-top:20px;">
      <button onclick="confirmLoadout()" style="padding:10px 20px;font-size:16px;">Confirm</button>
    </div>
  </div>

  <!-- ADA Command Modal -->
  <div id="ada-modal" style="display:none;position:fixed;top:50%;left:50%;
       transform:translate(-50%,-50%);z-index:9999;background:#111;padding:20px;
       border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.8);width:90%;
       max-width:600px;height:80%;color:#0ff;font-family:monospace;">
    <div id="ada-log" style="height:70%;overflow-y:auto;padding:10px;
          background:#000;border:1px solid #333;margin-bottom:10px;">
      ADA: Investigation interface activated.
    </div>

    <!-- ADA Buttons Interface -->
    <div id="ada-buttons" style="display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin-bottom:10px;">
      <button onclick="handleAdaCommand('map')">üó∫ Map</button>
      <button onclick="handleAdaCommand('move')">üö™ Move</button>
      <button onclick="openItemUsePopup()">üéí Use Item</button>
      <button onclick="handleAdaCommand('inventory')">üì¶ Inventory</button>
      <button onclick="openGuess()">üëª Guess Ghost</button>
      <button onclick="handleAdaCommand('end')">üö´ End</button>
    </div>

    <div id="status-bar">
      Turn: <span id="turn-counter">0</span> | Sanity: <span id="sanity-bar">100</span>%
    </div>
  </div>
<!-- ITEM USE POPUP -->
<div id="item-use-popup" style="display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);background:#111;padding:20px;border-radius:10px;
  border:2px solid #0ff;z-index:10000;width:90%;max-width:400px;">
  <h2 style="color:#0ff;text-align:center;">Select an item to use</h2>
  <div id="item-use-list" style="margin-top:12px;display:flex;flex-direction:column;gap:8px;"></div>
  <button onclick="closeItemUsePopup()" style="margin-top:12px;background:#000;
    border:1px solid #0ff;color:#0ff;padding:6px 12px;cursor:pointer;">Cancel</button>
</div>

<!-- GHOST GUESSING MODAL -->
<div id="guess-popup" style="display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);background:#111;padding:20px;border-radius:10px;
  border:2px solid #0ff;z-index:10000;width:90%;max-width:600px;">
  <h2 style="color:#0ff;text-align:center;">Who do you think the ghost is?</h2>
  <div id="guess-list" style="max-height:300px;overflow-y:auto;display:grid;
    grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:6px;margin-top:12px;"></div>
  <button onclick="closeGuess()" style="margin-top:12px;background:#000;
    border:1px solid #0ff;color:#0ff;padding:6px 12px;cursor:pointer;">Cancel</button>
</div>

<!-- END SCREEN -->
<div id="end-screen" style="display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);background:#111;padding:20px;border-radius:10px;
  border:2px solid #0ff;z-index:10000;width:90%;max-width:500px;text-align:center;
  font-family:monospace;color:#0ff;">
  <div id="end-message" style="margin-bottom:16px;"></div>
  <button onclick="startNewGame()" style="background:#000;border:1px solid #0ff;
    color:#0ff;padding:6px 16px;cursor:pointer;">üîÅ Start New Game</button>
</div>
<div id="loadout-screen" style="display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);background:#111;padding:20px;
  border-radius:10px;border:2px solid #0ff;z-index:10000;width:90%;
  max-width:500px;color:#0ff;font-family:monospace;text-align:center;">
  <h2>Select 3 items to bring (Notebook & Lighter are automatic)</h2>
  <div id="item-selection" style="display:flex;flex-wrap:wrap;gap:8px;
    justify-content:center;margin-top:10px;">
    <!-- checkboxes dynamically inserted -->
  </div>
  <button onclick="confirmLoadout()" style="margin-top:12px;
    padding:6px 12px;background:#000;border:1px solid #0ff;color:#0ff;">
    Confirm Loadout
  </button>
</div>
<script>
// === Game Variables ===
  const allLoadoutItems = [
  "EMF", "Spirit Box", "Thermometer", "Crucifix", "Salt", 
  "Smudge", "Camera", "UV Light", "D.O.T.S", "Ghost Writing Book", "Motion Sensor"
];

const game = {
  started: false,
  active: false,
  turn: 0,
  sanity: 100,
  xp: 0,
  level: 1,
  prestige: 0,
  inventory: ["Notebook", "Lighter"],
  vanStock: {},
  usedItems: [],
  ghost: null,
  ghostRoom: "Living Room",
  evidence: [],
  guessedGhost: null,
  position: [0, 0],
  map: [
    ['‚óè','_','_'],
    ['|','_','|'],
    ['|','_','|']
  ],
  roomNameMap: [
    ['Van','Foyer','Kitchen'],
    ['Basement','Living Room','Bathroom'],
    ['Garage','Bedroom','Storage']
  ],
  protections: {
    smudgeCount: 2,
    crucifixPlaced: false
  },
  events: [],
  journal: [],
  settings: {
    difficulty: 'Amateur',
    noEvidenceMode: false,
    allowHints: true
  }
};

// === Loadout Functions ===

  function showLoadoutMenu() {
  const container = document.getElementById("item-selection");
  container.innerHTML = "";
  allLoadoutItems.forEach(item => {
    const label = document.createElement("label");
    label.style = "color:#0ff;font-family:monospace;";
    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.value = item;
    checkbox.onchange = limitLoadoutCheck;
    label.appendChild(checkbox);
    label.append(" " + item);
    container.appendChild(label);
  });
  document.getElementById("loadout-screen").style.display = "block";
}

function limitLoadoutCheck() {
  const selected = document.querySelectorAll('#item-selection input:checked');
  if (selected.length > 3) this.checked = false;
}

function confirmLoadout() {
  const selected = Array.from(document.querySelectorAll('#item-selection input:checked'));
  if (selected.length > 3) return alert("Max 3 items.");

  game.inventory = selected.map(cb => cb.value).concat("Notebook", "Lighter");

  // Stock van with remaining items
  game.vanStock = {};
  const remaining = allLoadoutItems.filter(i => !game.inventory.includes(i));
  remaining.forEach(name => {
    game.vanStock[name] = (name === "Smudge" ? 4 : name === "Salt" ? 3 : 1); // amount logic
  });

  document.getElementById("loadout-screen").style.display = "none";
  startInvestigation(); // calls the real game logic
}
  function startInvestigation() {
  game.started = true;
  game.active = true;
  game.turn = 0;
  game.sanity = 100;
  game.ghost = Object.keys(ghostProfiles)[Math.floor(Math.random() * Object.keys(ghostProfiles).length)];
  game.ghostRoom = game.roomNameMap[1][1]; // middle room (Living Room)
  document.getElementById("ada-modal").style.display = "block";
  simulateTyping(introDialogues[Math.floor(Math.random() * introDialogues.length)], "Deo");
}

// === ADA Command Handler + Typing Simulation ===
function simulateTyping(text, from = "ADA") {
  const line = document.createElement("div");
  line.innerHTML = `<strong>${from}:</strong> `;
  const span = document.createElement("span");
  const cursor = document.createElement("span");
  cursor.setAttribute("id", "ada-typing");
  cursor.textContent = "|";
  span.textContent = "";
  line.appendChild(span);
  line.appendChild(cursor);
  document.getElementById("ada-log").appendChild(line);
  let i = 0;
  function typeChar() {
    if (i < text.length) {
      span.textContent += text[i++];
      setTimeout(typeChar, 20 + Math.random() * 20);
      document.getElementById("ada-log").scrollTop = document.getElementById("ada-log").scrollHeight;
    } else {
      cursor.remove();
    }
  }
  typeChar();
}

function handleAdaCommand(cmd) {
  simulateTyping("> " + cmd, "You");
  const res = respondTo(cmd);
  setTimeout(() => simulateTyping(res), 300);
}
</script>

<script>
// === Ghost Guessing Modal ===
function openGuess() {
  const popup = document.getElementById("guess-popup");
  const list = document.getElementById("guess-list");
  list.innerHTML = "";
  Object.keys(ghostProfiles).forEach(name => {
    const btn = document.createElement("button");
    btn.textContent = name.toUpperCase();
    btn.onclick = () => {
      closeGuess();
      processGuess(name);
    };
    list.appendChild(btn);
  });
  popup.style.display = "block";
}

function closeGuess() {
  document.getElementById("guess-popup").style.display = "none";
}

function processGuess(name) {
  game.guessedGhost = name;
  const correct = name === game.ghost;
  const message = correct
    ? `Correct! The ghost was a ${name.toUpperCase()}.`
    : `Wrong. It was actually a ${game.ghost.toUpperCase()}.`;
  simulateTyping(message);
  game.active = false;
  document.getElementById("end-message").textContent = message;
  document.getElementById("end-screen").style.display = "block";
}
</script>

<script>
// === Item Use Modal ===
function openItemUsePopup() {
  const list = document.getElementById("item-use-list");
  list.innerHTML = "";
  game.inventory.forEach(item => {
    const btn = document.createElement("button");
    btn.textContent = item;
    btn.onclick = () => {
      useItem(item);
      closeItemUsePopup();
    };
    list.appendChild(btn);
  });
  document.getElementById("item-use-popup").style.display = "block";
}

function closeItemUsePopup() {
  document.getElementById("item-use-popup").style.display = "none";
}

function useItem(item) {
  const lower = item.toLowerCase();
  if (lower === "smudge") {
    simulateTyping("You used a Smudge Stick. The area feels momentarily safer.");
    game.protections.smudgeCount--;
    if (game.protections.smudgeCount <= 0) {
      game.inventory = game.inventory.filter(i => i !== item);
    }
  } else if (lower === "emf") {
    simulateTyping("You scan the room with the EMF reader...");
  } else {
    simulateTyping(`You use the ${item}.`);
  }
}
</script>

<script>
// === Game Loop Start ===
function startGameFlow() {
  const keys = Object.keys(ghostProfiles);
  game.ghost = keys[Math.floor(Math.random() * keys.length)];
  game.ghostRoom = game.roomNameMap[1][1]; // Living Room default
  game.turn = 0;
  game.sanity = 100;
  document.getElementById("ada-modal").style.display = "block";
  simulateTyping(introDialogues[Math.floor(Math.random() * introDialogues.length)], "Deo");
}
</script>

<script>
// === End Screen Restart Logic ===
function startNewGame() {
  window.location.reload();
}
</script>
<script>
function respondTo(cmd) {
  const command = cmd.trim().toLowerCase();
  if (!command) return;
  game.turn++;
  updateStatus();

  if (command === "start") {
    game.started = true;
    game.active = true;
    const keys = Object.keys(ghostProfiles);
    game.ghost = keys[Math.floor(Math.random() * keys.length)];
    game.ghostRoom = game.roomNameMap[1][1]; // Living Room
    document.getElementById("game-ui").style.display = 'block';
    return "Investigation started. Use your tools and deduction skills wisely.";
  }

  if (command === "map") return updateMapDisplay();

  if (command === "move") {
    let [x, y] = game.position;
    y = (y + 1) % 3;
    game.position = [x, y];
    game.sanity = Math.max(0, game.sanity - 5);
    updateStatus();
    const inGhostRoom = game.roomNameMap[x][y] === game.ghostRoom;
    const activity = inGhostRoom ? ghostProfiles[game.ghost].behavior : "You feel watched, but nothing happens.";
    return `You moved to ${game.roomNameMap[x][y]}. ${activity}`;
  }

  if (command === "inventory") {
    if (!game.inventory.length) return "You have no items.";
    return "Inventory: " + game.inventory.join(", ");
  }

  if (command.startsWith("use ")) {
    const item = command.split("use ")[1].trim();
    return useGameItem(item);
  }

  if (command === "end") {
    game.started = false;
    game.active = false;
    document.getElementById("game-ui").style.display = 'none';
    return `Investigation ended. The ghost was a ${game.ghost.toUpperCase()}.`;
  }

  if (command.startsWith("add evidence ")) {
    const ev = command.replace("add evidence ", "").trim();
    if (!ev) return "Specify which evidence to add.";
    if (!game.evidence.includes(ev)) {
      game.evidence.push(ev);
      return `${ev} added to your journal.`;
    }
    return `${ev} is already recorded.`;
  }

  return "Unknown command. Try: map, move, use [item], inventory, guess, end.";
}

function useGameItem(item) {
  const itemLower = item.toLowerCase();
  if (!game.inventory.map(i => i.toLowerCase()).includes(itemLower)) {
    return `You don't have a ${item}.`;
  }

  switch (itemLower) {
    case "smudge":
      if (game.protections.smudgeCount > 0) {
        game.protections.smudgeCount--;
        return "You used a Smudge Stick. The area feels momentarily safer.";
      } else {
        return "You are out of Smudge Sticks.";
      }

    case "emf":
      return "The EMF reader lights up... moderate reading.";

    case "candle":
      return "You light a candle. The flame flickers slightly.";

    default:
      return `You used the ${item}.`;
  }
}
</script>
<script>
function openItemUsePopup() {
  const list = document.getElementById("item-use-list");
  list.innerHTML = "";
  game.inventory.forEach(item => {
    const btn = document.createElement("button");
    btn.textContent = item;
    btn.style.padding = "6px 12px";
    btn.onclick = () => {
      closeItemUsePopup();
      handleAdaCommand("use " + item);
      if (["smudge", "salt", "crucifix"].includes(item.toLowerCase())) {
        game.inventory = game.inventory.filter(i => i !== item);
      }
    };
    list.appendChild(btn);
  });
  document.getElementById("item-use-popup").style.display = "block";
}

function closeItemUsePopup() {
  document.getElementById("item-use-popup").style.display = "none";
}

function openGuess() {
  const list = document.getElementById("guess-list");
  list.innerHTML = "";
  Object.keys(ghostProfiles).forEach(ghost => {
    const btn = document.createElement("button");
    btn.textContent = ghost.toUpperCase();
    btn.onclick = () => {
      closeGuess();
      processGuess(ghost);
    };
    list.appendChild(btn);
  });
  document.getElementById("guess-popup").style.display = "block";
}

function closeGuess() {
  document.getElementById("guess-popup").style.display = "none";
}

function processGuess(guess) {
  if (!game.started) return;
  if (guess === game.ghost) {
    endGame(`‚úÖ Correct! The ghost was ${guess.toUpperCase()}.`);
  } else {
    endGame(`‚ùå Incorrect. The ghost was ${game.ghost.toUpperCase()}.`);
  }
}

function endGame(message) {
  simulateTyping(message);
  document.getElementById("end-message").textContent = message;
  document.getElementById("end-screen").style.display = "block";
  game.started = false;
  game.active = false;
}

function startNewGame() {
  location.reload();
}
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const startBtn = document.getElementById("start-button-ada");
  const adaModal = document.getElementById("ada-modal");
  const turnCounter = document.getElementById("turn-counter");
  const sanityBar = document.getElementById("sanity-bar");
  const logBox = document.getElementById("ada-log");

  startBtn.addEventListener("click", () => {
    document.getElementById("main-menu").style.display = "none";
    adaModal.style.display = "block";
    simulateTyping(introDialogues[Math.floor(Math.random() * introDialogues.length)], "Deo");
    startGame();
  });

  function startGame() {
    game.started = true;
    game.active = true;
    game.turn = 0;
    game.sanity = 100;
    game.inventory = ['Notebook', 'Lighter', 'EMF', 'Smudge'];
    game.ghost = Object.keys(ghostProfiles)[Math.floor(Math.random() * Object.keys(ghostProfiles).length)];
    game.ghostRoom = game.roomNameMap[1][1]; // Living Room default
    updateStatus();
    log("Your investigation begins. Use the command buttons to explore or take actions.");
  }

  function updateStatus() {
    turnCounter.textContent = game.turn;
    sanityBar.textContent = game.sanity;
  }

  function log(text, from = "ADA") {
    const entry = document.createElement("div");
    entry.innerHTML = `<strong>${from}:</strong> <span>${text}</span>`;
    logBox.appendChild(entry);
    logBox.scrollTop = logBox.scrollHeight;
  }

  window.simulateTyping = function simulateTyping(text, from = "ADA") {
    const line = document.createElement("div");
    line.innerHTML = `<strong>${from}:</strong> `;
    const span = document.createElement("span");
    line.appendChild(span);
    const cursor = document.createElement("span");
    cursor.setAttribute("id", "ada-typing");
    cursor.textContent = "|";
    line.appendChild(cursor);
    logBox.appendChild(line);

    let i = 0;
    function type() {
      if (i < text.length) {
        span.textContent += text[i++];
        logBox.scrollTop = logBox.scrollHeight;
        setTimeout(type, 18 + Math.random() * 30);
      } else {
        cursor.remove();
      }
    }
    type();
  };

  window.handleAdaCommand = function handleAdaCommand(cmd) {
    simulateTyping(`> ${cmd}`, "You");
    const result = respondTo(cmd);
    setTimeout(() => simulateTyping(result), 300);
  };

  window.respondTo = function respondTo(command) {
    const cmd = command.trim().toLowerCase();
    if (!cmd) return;

    if (!game.started || !game.active) return "The investigation hasn't started.";

    game.turn++;
    game.sanity = Math.max(0, game.sanity - 5);
    updateStatus();

    if (cmd === "map") {
      let mapText = "";
      for (let i = 0; i < game.map.length; i++) {
        for (let j = 0; j < game.map[i].length; j++) {
          mapText += (i === game.position[0] && j === game.position[1]) ? "‚óè " : game.map[i][j] + " ";
        }
        mapText += "\n";
      }
      return mapText;
    }

    if (cmd === "move") {
      let [x, y] = game.position;
      y = (y + 1) % 3;
      game.position = [x, y];
      return ghostProfiles[game.ghost].behavior + "\n" + respondTo("map");
    }

    if (cmd === "inventory") {
      return "You have: " + game.inventory.join(", ");
    }

    if (cmd.startsWith("use ")) {
      const item = cmd.slice(4).trim().toLowerCase();
      if (!game.inventory.map(i => i.toLowerCase()).includes(item)) {
        return "You don't have that item.";
      }
      if (item === "smudge") {
        game.sanity += 10;
        return "You smudged the area. The ghost seems disturbed.";
      }
      if (item === "emf") {
        return "EMF Reader buzzes faintly...";
      }
      return `You used the ${item}.`;
    }

    if (cmd === "end") {
      game.started = false;
      game.active = false;
      return `Investigation ended. The ghost was ${game.ghost.toUpperCase()}.`;
    }

    return "Unknown command.";
  };
});
</script>
<script>
function lightningFlash() {
  const flash = document.getElementById('flash-overlay');
  if (!flash) return;
  flash.style.opacity = '0.4';
  setTimeout(() => {
    flash.style.opacity = '0';
  }, 100);
}
setInterval(() => {
  setTimeout(lightningFlash, Math.random() * 2000);
}, 10000);
</script>
<script>
const canvas = document.getElementById('orb-canvas');
const ctx = canvas.getContext('2d');
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

function createOrb() {
  return {
    x: Math.random() * width,
    y: Math.random() * height,
    vx: (Math.random() - 0.5) * 0.8,
    vy: (Math.random() - 0.5) * 0.8,
    baseRadius: Math.random() * 2 + 1,
    radius: 1,
    opacity: 0,
    fadeIn: true,
    tick: 0,
    changeInterval: Math.floor(Math.random() * 100 + 50)
  };
}

let orbs = Array.from({ length: 12 }, createOrb);

function animateOrbs() {
  ctx.clearRect(0, 0, width, height);
  orbs.forEach((orb, i) => {
    orb.tick++;
    orb.radius = orb.baseRadius + Math.sin(orb.tick / 30) * 0.5;

    // Fade in/out
    if (orb.fadeIn) {
      orb.opacity += 0.01;
      if (orb.opacity >= 0.7) orb.fadeIn = false;
    } else {
      orb.opacity -= 0.001;
    }

    // Respawn if invisible
    if (orb.opacity <= 0.01) {
      orbs[i] = createOrb();
      return;
    }

    // Drift change
    if (orb.tick % orb.changeInterval === 0) {
      let angle = Math.random() * Math.PI * 2;
      let speed = Math.sqrt(orb.vx ** 2 + orb.vy ** 2);
      orb.vx = Math.cos(angle) * speed;
      orb.vy = Math.sin(angle) * speed;
    }

    // Move
    orb.x += orb.vx;
    orb.y += orb.vy;

    // Bounce
    if (orb.x <= 0 || orb.x >= width) orb.vx *= -1;
    if (orb.y <= 0 || orb.y >= height) orb.vy *= -1;

    // Draw
    ctx.beginPath();
    ctx.arc(orb.x, orb.y, orb.radius, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(255,255,255,${orb.opacity})`;
    ctx.shadowColor = `rgba(255,255,255,${orb.opacity * 0.6})`;
    ctx.shadowBlur = 10 + orb.opacity * 10;
    ctx.fill();
  });

  requestAnimationFrame(animateOrbs);
}

animateOrbs();

window.addEventListener('resize', () => {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});
</script>
<footer>
  Shark‚ÄëBlades ‚Äî Phasma‚ÄëPhoney Prototype Web Build
  <span class="version-tag" onclick="document.getElementById('changelog-modal').style.display = 'block'">
    Build v1.4.0
  </span>
</footer>

<div id="changelog-modal" style="display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);background:#111;padding:20px;
  border:2px solid #0ff;border-radius:10px;z-index:9999;color:#0ff;
  font-family:monospace;width:90%;max-width:500px;text-align:left;">

  <h2 style="margin-top:0;color:#0ff;">Phasma‚ÄëPhoney v1.4.0</h2>
  <ul style="padding-left:20px;font-size:0.95em;">
    <li>‚úÖ Interactive ADA UI (button-based)</li>
    <li>‚úÖ Full ghost guessing modal</li>
    <li>‚úÖ Animated floating spirit particles (orbs)</li>
    <li>‚úÖ Lightning flash effects every few seconds</li>
    <li>‚úÖ Item use interface + consumable tracking</li>
    <li>‚úÖ End-game result + "Start New Game" logic</li>
  </ul>
  <button onclick="document.getElementById('changelog-modal').style.display = 'none'"
          style="margin-top:12px;background:#000;border:1px solid #0ff;
                 color:#0ff;padding:6px 12px;cursor:pointer;">
    Close
  </button>
</div>
