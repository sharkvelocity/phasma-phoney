<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PhasmaPhoney</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="Shark-Blades" />
  <meta name="description" content="Turn-based ghost hunting strategy game based on Phasmophobia." />
  <meta name="keywords" content="PhasmaPhoney, Phasmophobia, ghost, hunting, game, HTML" />
  <meta property="og:type" content="article" />
  <meta property="og:site_name" content="PhasmaPhoney" />
  <meta property="og:url" content="http://www." />
  <meta name="google-site-verification" content="2zaxjMijj2SXwFDx3Fe6sQUNzXXZiAAkAP92q6ZFWSg" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
      background-color: #000;
      font-family: Helvetica, Arial, sans-serif;
    }

    #background-image {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("");
      background-size: cover;
      background-position: center;
      z-index: -3;
    }

    #background-logo {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url("./logo.png");
      background-repeat: no-repeat;
      background-position: center center;
      background-size: contain;
      opacity: 0.1;
      z-index: -4;
    }

    #clouds1, #clouds2 {
      position: fixed;
      top: 0; left: 0;
      width: 300%;
      height: 100%;
      pointer-events: none;
      z-index: 200;
    }

    #clouds1 {
      background: linear-gradient(to right, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0) 100%);
      opacity: 0.4;
      filter: blur(10px);
      animation: cloudDrift1 80s linear infinite;
    }

    #clouds2 {
      background: linear-gradient(to right, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0) 100%);
      opacity: 0.3;
      filter: blur(14px);
      animation: cloudDrift2 120s linear infinite;
    }

    @keyframes cloudDrift1 {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    @keyframes cloudDrift2 {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    #orb-canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 9999;
    }

    #flash-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: white;
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
    }

    @keyframes typing-blink {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }

    #ada-typing {
      font-family: monospace;
      color: #0ff;
      display: inline-block;
      margin-left: 4px;
      animation: typing-blink 1s infinite;
    }

    footer {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-size: 0.9em;
      font-family: sans-serif;
      z-index: 9999;
    }

    @media (max-width: 600px) {
      #start-button-ada {
        font-size: 18px !important;
        padding: 12px 30px !important;
      }
      #ada-modal {
        width: 95% !important;
        padding: 12px !important;
      }
      #ada-log {
        font-size: 13px !important;
      }
    }
  </style>
</head>
<body>
  <div id="background-logo"></div>
  <div id="background-image"></div>
  <div id="clouds1"></div>
  <div id="clouds2"></div>
  <div id="flash-overlay"></div>
  <canvas id="orb-canvas"></canvas>
  <!-- === MAIN MENU === -->
  <div id="main-menu" style="text-align: center; color: white; margin-top: 40px;">
    <ul style="list-style-type: none; padding: 0; font-size: 1.2em;">
      <button id="start-button-ada"
              onclick="startAda()"
              style="position:absolute;top:35%;left:50%;transform:translateX(-50%);
                     padding:16px 48px;font-size:24px;z-index:5000;
                     background:#111;color:#eee;border:2px solid #666;cursor:pointer;">
        Start
      </button>
    </ul>
    <p style="font-style: italic; font-size: 0.95em;">
      Deo: ‚ÄúWelcome back, PhasmaPhoney. Let‚Äôs hope your deduction is better than your taste in candles.‚Äù
    </p>
  </div>

  <!-- === ADA MODAL === -->
  <div id="ada-modal" style="display:none;position:fixed;top:50%;left:50%;
    transform:translate(-50%,-50%);z-index:9999;background:#111;padding:20px;
    border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.8);width:90%;
    max-width:600px;height:80%;color:#0ff;font-family:monospace;">
    <div id="ada-log" style="height:70%;overflow-y:auto;padding:10px;
          background:#000;border:1px solid #333;margin-bottom:10px;">
      ADA: I'm here to assist you.
    </div>

    <!-- ADA BUTTON INTERFACE -->
    <div id="ada-buttons" style="display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin-bottom:10px;">
      <button onclick="handleAdaCommand('map')">üó∫ Map</button>
      <button onclick="handleAdaCommand('move')">üö™ Move</button>
      <button onclick="openItemUsePopup()">üéí Use Item</button>
      <button onclick="handleAdaCommand('inventory')">üì¶ Inventory</button>
      <button onclick="openGuess()">üëª Guess Ghost</button>
      <button onclick="handleAdaCommand('end')">üö´ End</button>
    </div>

    <div id="status-bar">
      Turn: <span id="turn-counter">0</span> | Sanity: <span id="sanity-bar">100</span>%
    </div>
  </div>

  <!-- === GUESS POPUP === -->
  <div id="guess-popup" style="display:none;position:fixed;top:50%;left:50%;
    transform:translate(-50%,-50%);background:#111;padding:20px;
    border-radius:10px;border:2px solid #0ff;z-index:10000;width:90%;max-width:600px;">
    <h2 style="color:#0ff;text-align:center;">Who do you think the ghost is?</h2>
    <div id="guess-list" style="max-height:300px;overflow-y:auto;display:grid;
        grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:6px;margin-top:12px;"></div>
    <button onclick="closeGuess()" style="margin-top:12px;background:#000;
      border:1px solid #0ff;color:#0ff;padding:6px 12px;cursor:pointer;">Cancel</button>
  </div>

  <!-- === ITEM USE POPUP === -->
  <div id="item-use-popup" style="display:none;position:fixed;top:50%;left:50%;
    transform:translate(-50%,-50%);background:#111;padding:20px;
    border-radius:10px;border:2px solid #0ff;z-index:10000;width:90%;max-width:400px;">
    <h2 style="color:#0ff;text-align:center;">Select an item to use</h2>
    <div id="item-use-list" style="margin-top:12px;display:flex;
      flex-direction:column;gap:8px;"></div>
    <button onclick="closeItemUsePopup()" style="margin-top:12px;background:#000;
      border:1px solid #0ff;color:#0ff;padding:6px 12px;cursor:pointer;">Cancel</button>
  </div>

  <!-- === GAME STATE AND UI (Optional Display Elements) === -->
  <div id="game-state" style="margin-top:20px;color:#0f0;font-family:monospace;"></div>
  <div id="game-ui"
       style="display:none;margin-top:20px;border:1px solid #0ff;
              padding:10px;color:#0ff;font-family:monospace;background:#000;">
  </div>

  <!-- === GAME END SCREEN === -->
  <div id="end-screen" style="display:none; position:fixed; top:50%; left:50%;
    transform:translate(-50%,-50%); background:#111; border:2px solid #0ff;
    padding:20px; z-index:9999; color:#0ff; font-family:monospace; text-align:center;">
    <div id="end-message" style="margin-bottom:12px;"></div>
    <button onclick="startNewGame()" style="padding:6px 14px; font-size:1em;
      background:#000; border:1px solid #0ff; color:#0ff; cursor:pointer;">
      Start New Game
    </button>
  </div>
<script>
// === Ghost Profiles Database ===
const ghostProfiles = {
  spirit: {
    intro: "Spirits are common and leave minimal traces.",
    behavior: "You hear soft whispers echoing from nowhere..."
  },
  wraith: {
    intro: "Wraiths float silently and leave no footprints.",
    behavior: "The air shifts unnaturally. No trace in the salt."
  },
  poltergeist: {
    intro: "Poltergeists throw objects violently and often.",
    behavior: "A loud crash! Something was hurled across the room!"
  },
  demon: {
    intro: "Demons are aggressive and hunt often.",
    behavior: "Growl... the temperature drops violently!"
  },
  mare: {
    intro: "Mares thrive in darkness and disrupt light sources.",
    behavior: "The lights flicker and cut. A chill floods the room."
  },
  banshee: {
    intro: "Banshees fixate on one person and wail softly.",
    behavior: "You hear a melodic hum... almost like singing."
  },
  jinn: {
    intro: "Jinns are territorial and manipulate electronics.",
    behavior: "The EMF screams as energy pulses through the air."
  },
  revenant: {
    intro: "Revenants are slow unless hunting. Then they sprint.",
    behavior: "Heavy dragging steps... followed by a sudden rush."
  },
  shade: {
    intro: "Shades are shy and calm when observed.",
    behavior: "Nothing stirs. It's too quiet..."
  },
  yurei: {
    intro: "Yureis drain sanity and slam doors.",
    behavior: "Your vision clouds as the door SLAMS behind you!"
  },
  oni: {
    intro: "Onis are loud and quick to act.",
    behavior: "A bang behind you! Something moves fast."
  },
  yokai: {
    intro: "Yokais are enraged by voices.",
    behavior: "A voice mimics yours... but no one is near."
  },
  hantu: {
    intro: "Hantus manifest strongest in freezing areas.",
    behavior: "You can see your breath... the air freezes around you."
  },
  goryo: {
    intro: "Goryos show only through video equipment.",
    behavior: "Something flickers on the camera feed... then vanishes."
  },
  myling: {
    intro: "Mylings are silent but make loud steps.",
    behavior: "Thump. Thump. Then complete silence."
  },
  onryo: {
    intro: "Onryos lash out when flames go out.",
    behavior: "The candle snuffs‚Äîfollowed by a deep hiss."
  },
  "the twins": {
    intro: "The Twins act independently and inconsistently.",
    behavior: "Footsteps echo in two directions simultaneously."
  },
  raiju: {
    intro: "Raijus feed off electronics.",
    behavior: "Every device sparks. The air smells of ozone."
  },
  obake: {
    intro: "Obakes leave distorted fingerprints.",
    behavior: "You glimpse a warped print before it disappears."
  },
  "the mimic": {
    intro: "The Mimic imitates other ghosts‚Äîpoorly.",
    behavior: "The signs don't line up... it's masking something."
  },
  moroi: {
    intro: "Morois curse their victims and drain their mind.",
    behavior: "A headache pulses... your thoughts scatter."
  },
  deogen: {
    intro: "Deogens always know where you are.",
    behavior: "You move. It follows. Slowly, but deliberately."
  },
  thaye: {
    intro: "Thaye ages and weakens the longer it's seen.",
    behavior: "You feel less fear now... but it's still watching."
  },
  succubus: {
    intro: "The Succubus seduces and siphons strength.",
    behavior: "You're compelled to stay... even as dread creeps in."
  }
};
</script>

<script>
// === Game State Object ===
const game = {
  started: false,
  active: false,
  turn: 0,
  sanity: 100,
  xp: 0,
  level: 1,
  prestige: 0,
  inventory: ['Notebook', 'Lighter', 'EMF', 'Smudge'],
  usedItems: [],
  ghost: null,
  ghostRoom: "Living Room",
  evidence: [],
  guessedGhost: null,
  position: [0, 0],
  map: [
    ['‚óè','_','_'],
    ['|','_','|'],
    ['|','_','|']
  ],
  roomNameMap: [
    ['Van','Foyer','Kitchen'],
    ['Basement','Living Room','Bathroom'],
    ['Garage','Bedroom','Storage']
  ],
  protections: {
    smudgeCount: 2,
    crucifixPlaced: false
  },
  events: [],
  journal: [],
  settings: {
    difficulty: 'Amateur',
    noEvidenceMode: false,
    allowHints: true
  }
};

// === Intro Dialog Pool ===
const introDialogues = [
  "Deo: I've got a bad feeling about this one...",
  "Deo: Remember, this isn't a ghost story - it's real.",
  "Deo: Stay on your toes out there.",
  "Deo: Let's see what we're dealing with this time.",
  "Deo: Keep the lights on and the sanity high!"
];
</script>
<script>
// === ADA Command Dispatcher ===
function handleAdaCommand(cmd) {
  simulateTyping(`> ${cmd}`, "You");
  const res = respondTo(cmd);
  setTimeout(() => simulateTyping(res), 300);
}

// === Use Item Popup ===
function openItemPopup() {
  const container = document.getElementById("item-options");
  container.innerHTML = "";
  game.inventory.forEach(item => {
    const btn = document.createElement("button");
    btn.textContent = item;
    btn.onclick = () => {
      closeItemPopup();
      handleAdaCommand("use " + item.toLowerCase());
      removeIfConsumable(item);
    };
    container.appendChild(btn);
  });
  document.getElementById("item-popup").style.display = "block";
}

function closeItemPopup() {
  document.getElementById("item-popup").style.display = "none";
}

function removeIfConsumable(item) {
  const consumables = ["smudge", "salt", "crucifix"];
  if (consumables.includes(item.toLowerCase())) {
    const index = game.inventory.findIndex(i => i.toLowerCase() === item.toLowerCase());
    if (index !== -1) game.inventory.splice(index, 1);
  }
}

// === Ghost Guessing UI ===
function openGuessPopup() {
  const list = document.getElementById("guess-list");
  list.innerHTML = "";
  Object.keys(ghostProfiles).forEach(name => {
    const btn = document.createElement("button");
    btn.textContent = name.toUpperCase();
    btn.onclick = () => {
      closeGuessPopup();
      processGuess(name);
    };
    list.appendChild(btn);
  });
  document.getElementById("guess-popup").style.display = "block";
}

function closeGuessPopup() {
  document.getElementById("guess-popup").style.display = "none";
}

function processGuess(guessName) {
  if (guessName === game.ghost) {
    endGame("Correct! The ghost was a " + guessName.toUpperCase() + ".");
  } else {
    endGame("Incorrect. The ghost was a " + game.ghost.toUpperCase() + ".");
  }
}

function endGame(message) {
  simulateTyping(message);
  game.started = false;
  game.active = false;
  document.getElementById("end-message").textContent = message;
  document.getElementById("end-screen").style.display = "block";
}

function startNewGame() {
  location.reload();
}
</script>

<script>
// === Status Display Helpers ===
function updateStatus() {
  document.getElementById("turn-counter").textContent = game.turn;
  document.getElementById("sanity-bar").textContent = game.sanity;
}

function updateMapDisplay() {
  let [x, y] = game.position;
  let display = "";
  for (let i = 0; i < game.map.length; i++) {
    for (let j = 0; j < game.map[i].length; j++) {
      display += (i === x && j === y) ? "‚óè " : game.map[i][j] + " ";
    }
    display += "<br>";
  }
  return display;
}
</script>

<script>
// === Typing Simulation ===
function simulateTyping(text, from = "ADA") {
  const logBox = document.getElementById("ada-log");
  const line = document.createElement("div");
  line.innerHTML = `<strong>${from}:</strong> `;
  const span = document.createElement("span");
  const cursor = document.createElement("span");
  cursor.setAttribute("id", "ada-typing");
  cursor.textContent = "|";
  line.appendChild(span);
  line.appendChild(cursor);
  logBox.appendChild(line);

  let i = 0;
  function typeChar() {
    if (i < text.length) {
      span.textContent += text[i++];
      logBox.scrollTop = logBox.scrollHeight;
      setTimeout(typeChar, 18 + Math.random() * 30);
    } else {
      cursor.remove();
    }
  }
  typeChar();
}
</script>

<script>
// === Main ADA Command Interpreter ===
function respondTo(cmd) {
  const command = cmd.trim().toLowerCase();
  if (!command) return;
  game.turn++;
  updateStatus();

  if (command === "start") {
    game.started = true;
    game.active = true;
    const ghosts = Object.keys(ghostProfiles);
    game.ghost = ghosts[Math.floor(Math.random() * ghosts.length)];
    game.ghostRoom = "Living Room";
    document.getElementById("game-ui").style.display = 'block';
    return "Investigation started. Use the interface to proceed.";
  }

  if (command === "map") return updateMapDisplay();

  if (command === "move") {
    let [x, y] = game.position;
    y = (y + 1) % 3;
    game.position = [x, y];
    game.sanity = Math.max(0, game.sanity - 5);
    updateStatus();
    return "You moved. " + ghostProfiles[game.ghost].behavior + " " + updateMapDisplay();
  }

  if (command.startsWith("use ")) {
    const item = command.split("use ")[1].trim().toLowerCase();
    return "You used the " + item + ".";
  }

  if (command === "inventory") {
    return "Inventory: " + game.inventory.join(", ");
  }

  if (command === "end") {
    game.started = false;
    game.active = false;
    document.getElementById("game-ui").style.display = "none";
    return "Investigation ended. Ghost was: " + game.ghost.toUpperCase();
  }

  return "Unknown command.";
}
</script>
<!-- === ADA Knowledge Base and Lore Parser === -->
<script type="text/phasma-data">
PHASMA-PHONEY:
- Guess ghost by behavior
- No evidence default mode
- Turn-based mechanics with sanity
- Ghosts: Spirit, Wraith, Poltergeist, Demon, Mare, Thaye, Yurei, Onryo, The Mimic, Succubus, etc.
- Cursed Possessions: Mirror, Tarot Cards, Music Box, Voodoo Doll
- Succubus commentary unlocked after encounter
- XP and Prestige (Max Level 100 shown in Roman Numerals)
</script>

<script>
const rulesText = document.querySelector('script[type="text/phasma-data"]')?.innerText || '';
const ADA_KNOWLEDGE = rulesText.split("\n").filter(line => line.trim());

function adaParse(input) {
  const cmd = input.toLowerCase();
  if (cmd.includes("succubus")) return "The Succubus reveals itself only under rare conditions‚Äîwatch for seductive signs.";
  if (cmd.includes("mirror")) return "The Haunted Mirror reveals the ghost room... but at the cost of your sanity.";
  if (cmd.includes("cards")) return "Tarot Cards bring chaos: death, sanity, or salvation.";
  if (cmd.includes("prestige")) return "Prestige is shown as a Roman numeral. You can reach Level C (100).";
  if (cmd.includes("legacy")) return "Legacy entries track your ghost guesses, success rate, and experience.";
  if (cmd.includes("yurei")) return "Yurei can slam doors, drain sanity, and isolate you from light.";
  return null;
}
</script>

<!-- === Final DOM Initialization === -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const startBtn = document.getElementById("start-button-ada");
  const modal = document.getElementById("ada-modal");

  if (startBtn && modal) {
    startBtn.addEventListener("click", () => {
      modal.style.display = "block";
      const intro = introDialogues[Math.floor(Math.random() * introDialogues.length)];
      simulateTyping(intro, "Deo");
    });
  }
});
</script>

<!-- === Optional Lightning Flash Ambient Effect === -->
<script>
function lightningFlash() {
  const flash = document.getElementById('flash-overlay');
  if (!flash) return;
  flash.style.opacity = '0.4';
  setTimeout(() => { flash.style.opacity = '0'; }, 100);
}
setInterval(() => {
  setTimeout(lightningFlash, Math.random() * 2000);
}, 10000);
</script>

<!-- === Footer with Version Info === -->
<footer>
  Shark‚ÄëBlades ‚Äî Phasma‚ÄëPhoney: Fan-built turn-based ghost deduction game.
  <span class="version-tag" onclick="document.getElementById('changelog-modal').style.display = 'block'">
    Build v1.3.0
  </span>
</footer>

<!-- === Changelog Modal === -->
<div id="changelog-modal" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  width:90%;max-width:500px;background:#111;border:2px solid #444;padding:16px;color:#0f0;
  z-index:9999;font-family:monospace;box-shadow:0 0 20px rgba(0,255,0,0.2);">
  <h2 style="margin-top:0;color:#0ff;font-size:1.3em;">Phasma‚ÄëPhoney Build v1.3.0</h2>
  <ul style="padding-left:20px;font-size:0.95em;">
    <li>Replaced all command typing with ADA button interface</li>
    <li>Interactive ghost guessing popup</li>
    <li>Inventory use popup with real logic</li>
    <li>Consumables removed from inventory after use</li>
    <li>Clean UI layering and ambient effects (clouds, lightning, orbs)</li>
  </ul>
  <button onclick="document.getElementById('changelog-modal').style.display = 'none'"
    style="margin-top:12px;padding:6px 12px;font-size:0.9em;background:#000;
    border:1px solid #0ff;color:#0ff;cursor:pointer;">Close</button>
</div>
</body>
