<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Haunted Parallax Storm</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
      background: black;
    }

    .parallax-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      perspective: 1000px;
    }

    .parallax-layer {
      position: absolute;
      top: 0; left: 0;
      width: 110vw;
      height: 110vh;
      background-size: cover;
      background-position: center;
      transition: transform 0.1s ease-out;
      will-change: transform;
      z-index: 1;
    }

    .fog-layer {
      position: absolute;
      top: 0; left: 0;
      width: 200%;
      height: 200%;
      background: url('https://i.imgur.com/O2QKNRp.png') repeat;
      background-size: cover;
      animation: fogMove 60s linear infinite;
      opacity: 0.25;
      z-index: 6;
      pointer-events: none;
    }

    @keyframes fogMove {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .rain-layer {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 5;
      background-image:
        repeating-linear-gradient(transparent, transparent 2px, rgba(255,255,255,0.1) 3px, transparent 4px),
        repeating-linear-gradient(transparent, transparent 2px, rgba(255,255,255,0.05) 2.5px, transparent 3.5px);
      background-size: 2px 20px, 1px 10px;
      animation: rainFall 0.3s linear infinite;
      mix-blend-mode: screen;
      opacity: 0.5;
    }

    @keyframes rainFall {
      0% { background-position: 0 0, 0 0; }
      100% { background-position: 0 100%, 0 100%; }
    }

    .lightning {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: white;
      opacity: 0;
      z-index: 8;
      pointer-events: none;
    }

    .ghost-flash {
      position: absolute;
      width: 100px;
      height: 200px;
      background: url('https://i.imgur.com/MZcQ8KO.png') no-repeat center center;
      background-size: contain;
      opacity: 0;
      z-index: 9;
      pointer-events: none;
      animation: ghostFade 4s linear;
    }

    @keyframes ghostFade {
      0%, 100% { opacity: 0; }
      45% { opacity: 0; }
      50% { opacity: 0.9; }
      55% { opacity: 0; }
    }

    .flashlight-mask {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, rgba(255,255,255,0.0) 80px, rgba(0,0,0,0.95) 180px);
      pointer-events: none;
      z-index: 7;
      mix-blend-mode: multiply;
      transition: background-position 0.05s linear;
    }

    .nav-buttons {
      position: absolute;
      bottom: 10px;
      left: 0;
      width: 100%;
      text-align: center;
      z-index: 10;
    }

    .nav-buttons button {
      background: rgba(0,0,0,0.7);
      color: #eee;
      border: 1px solid #444;
      margin: 0 5px;
      padding: 8px 14px;
      border-radius: 4px;
      font-size: 14px;
    }

    @media (max-width: 600px) {
      .nav-buttons button {
        padding: 6px 10px;
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="parallax-container" id="parallax">
    <div class="parallax-layer" id="layer"
      style="background-image: url('/mnt/data/7CA5D5E7-9A58-4AC0-B21E-D2D7FECAD679.png');"></div>
    <div class="fog-layer"></div>
    <div class="rain-layer"></div>
    <div class="lightning" id="lightning"></div>
    <div class="flashlight-mask" id="flashlight"></div>
    <div class="nav-buttons">
      <button onclick="changeScene(0)">Room (Moon)</button>
      <button onclick="changeScene(1)">Outside (Forest)</button>
      <button onclick="changeScene(2)">Room (Dark)</button>
      <button onclick="toggleFlashlight()">Toggle Flashlight</button>
    </div>
  </div>

  <audio id="rain-sound" autoplay loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-17.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const layer = document.getElementById("layer");
    const lightning = document.getElementById("lightning");
    const parallax = document.getElementById("parallax");
    const flashlight = document.getElementById("flashlight");
    let flashlightOn = true;

    const scenes = [
      "/mnt/data/7CA5D5E7-9A58-4AC0-B21E-D2D7FECAD679.png",
      "/mnt/data/65518228-CF96-48D0-965B-413947698797.png",
      "/mnt/data/2BC54BB4-9A9E-43E7-9962-F38712B83E76.png"
    ];

    function changeScene(index) {
      layer.style.backgroundImage = `url('${scenes[index]}')`;
    }

    function applyParallax(xPercent, yPercent) {
      const xOffset = (xPercent - 0.5) * 20;
      const yOffset = (yPercent - 0.5) * 20;
      layer.style.transform = `translate(${xOffset}px, ${yOffset}px) scale(1.05)`;
    }

    document.addEventListener('mousemove', (e) => {
      const x = e.clientX / window.innerWidth;
      const y = e.clientY / window.innerHeight;
      applyParallax(x, y);
      moveFlashlight(e.clientX, e.clientY);
    });

    document.addEventListener('touchmove', (e) => {
      const touch = e.touches[0];
      if (touch) {
        const x = touch.clientX;
        const y = touch.clientY;
        moveFlashlight(x, y);
      }
    });

    window.addEventListener('deviceorientation', (e) => {
      const x = (e.gamma + 45) / 90;
      const y = (e.beta - 30) / 60;
      applyParallax(x, y);
    });

    // Lightning flashes
    setInterval(() => {
      lightning.style.opacity = 0.9;
      setTimeout(() => lightning.style.opacity = 0, 100 + Math.random() * 200);
    }, 5000 + Math.random() * 10000);

    // Ghost silhouette
    setInterval(() => {
      const ghost = document.createElement('div');
      ghost.className = 'ghost-flash';
      ghost.style.top = `${Math.random() * 60 + 20}%`;
      ghost.style.left = `${Math.random() * 70 + 10}%`;
      parallax.appendChild(ghost);
      setTimeout(() => ghost.remove(), 4000);
    }, 30000 + Math.random() * 30000);

    function toggleFlashlight() {
      flashlightOn = !flashlightOn;
      flashlight.style.display = flashlightOn ? 'block' : 'none';
    }

    function moveFlashlight(x, y) {
      if (!flashlightOn) return;
      flashlight.style.background = `radial-gradient(circle at ${x}px ${y}px, rgba(255,255,255,0.0) 80px, rgba(0,0,0,0.95) 180px)`;
    }
  </script>
</body>
</html>
