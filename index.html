<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Orbs + Lightning (Layered)</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: black;
      overflow: hidden;
    }
    .layer, canvas {
      position: absolute;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
    }
    .background { z-index: 1; }
    .lightning {
      z-index: 2;
      background: white;
      opacity: 0;
      transition: opacity 0.15s ease-in-out;
    }
    #orb-canvas { z-index: 3; }
    .foreground { z-index: 4; }
  </style>
</head>
<body>

<!-- LAYER ORDER -->
<img src="https://www.dropbox.com/scl/fi/b1r0ez74v60dnpuqxdzpj/background.png?rlkey=fbf34d7fobq08dihq0urnex3v&raw=1" class="layer background" />
<div class="layer lightning" id="lightning"></div>
<canvas id="orb-canvas"></canvas>
<img src="https://www.dropbox.com/scl/fi/l6i8ln2sjxg7r7xd5qei0/foreground.png?rlkey=mcxmo7gzk8hwu8o9k4oi8hdk0&raw=1" class="layer foreground" />

<script>
// LIGHTNING FLASH
const lightning = document.getElementById("lightning");
setInterval(() => {
  if (Math.random() > 0.6) {
    lightning.style.opacity = "0.4";
    setTimeout(() => lightning.style.opacity = "0", 150);
  }
}, 5000);
</script>

<script>
// FLOATING ORBS
const canvas = document.getElementById("orb-canvas");
const ctx = canvas.getContext("2d");
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

function createOrb() {
  return {
    x: Math.random() * width,
    y: Math.random() * height,
    vx: (Math.random() - 0.5) * 0.5,
    vy: (Math.random() - 0.5) * 0.5,
    radius: Math.random() * 2 + 1,
    opacity: 0,
    fadeIn: true,
    tick: 0
  };
}

let orbs = Array.from({ length: 20 }, createOrb);

function animateOrbs() {
  ctx.clearRect(0, 0, width, height);
  for (let orb of orbs) {
    orb.tick++;
    orb.opacity += orb.fadeIn ? 0.01 : -0.005;
    if (orb.opacity >= 0.6) orb.fadeIn = false;
    if (orb.opacity <= 0) Object.assign(orb, createOrb());

    orb.x += orb.vx;
    orb.y += orb.vy;
    if (orb.x < 0 || orb.x > width) orb.vx *= -1;
    if (orb.y < 0 || orb.y > height) orb.vy *= -1;

    ctx.beginPath();
    ctx.arc(orb.x, orb.y, orb.radius, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(255, 255, 255, ${orb.opacity})`;
    ctx.shadowColor = `rgba(255, 255, 255, ${orb.opacity * 0.6})`;
    ctx.shadowBlur = 10;
    ctx.fill();
  }
  requestAnimationFrame(animateOrbs);
}

animateOrbs();

window.addEventListener("resize", () => {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});
</script>

</body>
</html>